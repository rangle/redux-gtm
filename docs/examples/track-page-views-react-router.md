## Track Page Views When Using React Router

Suppose you've created a custom event in Google Tag Manager (GTM) for
tracking page views: `my-app-page-view`. And the custom event triggers a
Google Analytics tag that sends the custom Data Layer variable: `route`.

Suppose also that your application
uses [react-router](https://github.com/ReactTraining/react-router) in
combination with
[react-router-redux](https://github.com/reactjs/react-router-redux) to
manage routing.

Here's how you would use `redux-gtm` to map the routing actions
generated by `react-router-redux` with your custom GTM event
`my-app-page-view`:

Start by creating a mapping between your Redux actions and you analytics
events. In this example the action type we want to track is defined by
the `LOCATION_CHANGE` constant exposed by `react-router-redux`.

```js
// event-definitions.js

import { LOCATION_CHANGE } from 'react-router-redux';

const eventDefinitionsMap = {
  [LOCATION_CHANGE]: {
    eventName: 'my-app-page-view' // The name of the custom GTM event
    eventFields: (prevState, action) => ({
      // Map the custom Data Layer variable to the new route
      route: action.payload.location.pathname,
    }),
  },
}

export default eventDefinitionsMap;
```

Next, create the middleware using `createMiddleware` and your event
definitions. Then apply the middleware when creating the Redux store.

```js
// wherever you are creating the Redux store

import { createMiddleware } from 'redux-gtm'; // **
import eventDefinitionsMap from './event-definitions'; // **
import { createStore, applyMiddleware } from 'redux';
import reducer from './reducer';

const analyticsMiddleware = createMiddleware(eventDefinitionsMap);

const store = createStore(reducer, applyMiddleware(analyticsMiddleware));
```

That's it! Now, whenever the route changes, ReduxGTM will create and emit
an event to Google Tag Manger.
